<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Login Button Test - Namaskah SMS</title>\n    <style>\n        body {\n            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n            max-width: 800px;\n            margin: 0 auto;\n            padding: 20px;\n            background: #f5f5f5;\n        }\n        .test-container {\n            background: white;\n            padding: 30px;\n            border-radius: 12px;\n            box-shadow: 0 4px 6px rgba(0,0,0,0.1);\n            margin-bottom: 20px;\n        }\n        .test-section {\n            margin-bottom: 30px;\n            padding: 20px;\n            border: 2px solid #e5e7eb;\n            border-radius: 8px;\n        }\n        .test-section.success {\n            border-color: #10b981;\n            background: #f0fdf4;\n        }\n        .test-section.error {\n            border-color: #ef4444;\n            background: #fef2f2;\n        }\n        .test-section.warning {\n            border-color: #f59e0b;\n            background: #fffbeb;\n        }\n        input, button {\n            width: 100%;\n            padding: 12px;\n            margin: 8px 0;\n            border: 2px solid #e5e7eb;\n            border-radius: 8px;\n            font-size: 16px;\n        }\n        button {\n            background: #667eea;\n            color: white;\n            border: none;\n            cursor: pointer;\n            font-weight: 600;\n        }\n        button:hover {\n            background: #5a67d8;\n        }\n        button:disabled {\n            background: #9ca3af;\n            cursor: not-allowed;\n        }\n        .status {\n            padding: 10px;\n            margin: 10px 0;\n            border-radius: 6px;\n            font-weight: 600;\n        }\n        .status.success {\n            background: #d1fae5;\n            color: #065f46;\n            border: 1px solid #10b981;\n        }\n        .status.error {\n            background: #fee2e2;\n            color: #991b1b;\n            border: 1px solid #ef4444;\n        }\n        .status.info {\n            background: #dbeafe;\n            color: #1e40af;\n            border: 1px solid #3b82f6;\n        }\n        .test-results {\n            background: #f9fafb;\n            padding: 15px;\n            border-radius: 8px;\n            margin-top: 15px;\n            font-family: monospace;\n            font-size: 14px;\n            max-height: 300px;\n            overflow-y: auto;\n        }\n        .button-grid {\n            display: grid;\n            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n            gap: 10px;\n            margin-top: 15px;\n        }\n        .button-test {\n            padding: 10px;\n            background: #f3f4f6;\n            border-radius: 6px;\n            text-align: center;\n        }\n        .button-test button {\n            width: auto;\n            padding: 8px 16px;\n            margin: 5px;\n        }\n        .credentials {\n            background: #fef3c7;\n            border: 2px solid #f59e0b;\n            padding: 15px;\n            border-radius: 8px;\n            margin-bottom: 20px;\n        }\n    </style>\n</head>\n<body>\n    <div class=\"test-container\">\n        <h1>üß™ Namaskah SMS - Login Button Test</h1>\n        <p>This page tests the login functionality and button connections for Namaskah SMS.</p>\n        \n        <div class=\"credentials\">\n            <h3>üîë Test Credentials</h3>\n            <p><strong>Email:</strong> test@example.com</p>\n            <p><strong>Password:</strong> testpass123</p>\n            <p><strong>Admin:</strong> admin@namaskah.app / Namaskah@Admin2024</p>\n        </div>\n        \n        <div class=\"test-section\" id=\"connection-test\">\n            <h3>üåê Server Connection Test</h3>\n            <button onclick=\"testConnection()\">Test Server Connection</button>\n            <div id=\"connection-status\"></div>\n        </div>\n        \n        <div class=\"test-section\" id=\"login-test\">\n            <h3>üîê Login Functionality Test</h3>\n            <input type=\"email\" id=\"test-email\" placeholder=\"Email\" value=\"test@example.com\">\n            <input type=\"password\" id=\"test-password\" placeholder=\"Password\" value=\"testpass123\">\n            <button onclick=\"testLogin()\">Test Login</button>\n            <button onclick=\"testRegister()\">Test Register</button>\n            <div id=\"login-status\"></div>\n        </div>\n        \n        <div class=\"test-section\" id=\"auth-test\">\n            <h3>‚úÖ Authentication Test</h3>\n            <button onclick=\"testAuth()\">Test Authentication</button>\n            <div id=\"auth-status\"></div>\n        </div>\n        \n        <div class=\"test-section\" id=\"button-test\">\n            <h3>üîò Button Endpoint Tests</h3>\n            <div class=\"button-grid\">\n                <div class=\"button-test\">\n                    <button onclick=\"testEndpoint('/services/list', 'Services')\">Services List</button>\n                    <div id=\"services-result\"></div>\n                </div>\n                <div class=\"button-test\">\n                    <button onclick=\"testEndpoint('/analytics/dashboard', 'Analytics')\">Analytics</button>\n                    <div id=\"analytics-result\"></div>\n                </div>\n                <div class=\"button-test\">\n                    <button onclick=\"testEndpoint('/verifications/history', 'History')\">History</button>\n                    <div id=\"history-result\"></div>\n                </div>\n                <div class=\"button-test\">\n                    <button onclick=\"testEndpoint('/transactions/history', 'Transactions')\">Transactions</button>\n                    <div id=\"transactions-result\"></div>\n                </div>\n                <div class=\"button-test\">\n                    <button onclick=\"testEndpoint('/api-keys/list', 'API Keys')\">API Keys</button>\n                    <div id=\"api-keys-result\"></div>\n                </div>\n                <div class=\"button-test\">\n                    <button onclick=\"testEndpoint('/webhooks/list', 'Webhooks')\">Webhooks</button>\n                    <div id=\"webhooks-result\"></div>\n                </div>\n            </div>\n        </div>\n        \n        <div class=\"test-section\" id=\"verification-test\">\n            <h3>üì± Verification Test</h3>\n            <button onclick=\"testVerification()\">Test Create Verification</button>\n            <div id=\"verification-status\"></div>\n        </div>\n        \n        <div class=\"test-section\" id=\"admin-test\">\n            <h3>‚öôÔ∏è Admin Test</h3>\n            <button onclick=\"testAdmin()\">Test Admin Access</button>\n            <div id=\"admin-status\"></div>\n        </div>\n        \n        <div class=\"test-results\" id=\"test-log\">\n            <strong>Test Log:</strong><br>\n            Ready to run tests...\n        </div>\n    </div>\n    \n    <script>\n        const API_BASE = '';\n        let token = null;\n        \n        function log(message, type = 'info') {\n            const timestamp = new Date().toLocaleTimeString();\n            const logElement = document.getElementById('test-log');\n            const statusClass = type === 'success' ? 'success' : type === 'error' ? 'error' : 'info';\n            logElement.innerHTML += `<div class=\"status ${statusClass}\">[${timestamp}] ${message}</div>`;\n            logElement.scrollTop = logElement.scrollHeight;\n        }\n        \n        function updateStatus(elementId, message, type = 'info') {\n            const element = document.getElementById(elementId);\n            const statusClass = type === 'success' ? 'success' : type === 'error' ? 'error' : 'info';\n            element.innerHTML = `<div class=\"status ${statusClass}\">${message}</div>`;\n        }\n        \n        async function testConnection() {\n            log('Testing server connection...');\n            try {\n                const response = await fetch(`${API_BASE}/health`);\n                if (response.ok) {\n                    const data = await response.json();\n                    log('‚úÖ Server connection successful', 'success');\n                    updateStatus('connection-status', `‚úÖ Connected - Service: ${data.service} v${data.version}`, 'success');\n                    document.getElementById('connection-test').className = 'test-section success';\n                } else {\n                    log(`‚ùå Server responded with status: ${response.status}`, 'error');\n                    updateStatus('connection-status', `‚ùå Server error: ${response.status}`, 'error');\n                    document.getElementById('connection-test').className = 'test-section error';\n                }\n            } catch (error) {\n                log(`‚ùå Connection failed: ${error.message}`, 'error');\n                updateStatus('connection-status', `‚ùå Connection failed: ${error.message}`, 'error');\n                document.getElementById('connection-test').className = 'test-section error';\n            }\n        }\n        \n        async function testRegister() {\n            const email = document.getElementById('test-email').value;\n            const password = document.getElementById('test-password').value;\n            \n            if (!email || !password) {\n                log('‚ùå Please enter email and password', 'error');\n                return;\n            }\n            \n            log(`Testing registration for ${email}...`);\n            try {\n                const response = await fetch(`${API_BASE}/auth/register`, {\n                    method: 'POST',\n                    headers: {'Content-Type': 'application/json'},\n                    body: JSON.stringify({email, password})\n                });\n                \n                const data = await response.json();\n                \n                if (response.ok) {\n                    token = data.token;\n                    log('‚úÖ Registration successful', 'success');\n                    updateStatus('login-status', `‚úÖ Registered - Credits: ${data.credits}, Free: ${data.free_verifications}`, 'success');\n                    document.getElementById('login-test').className = 'test-section success';\n                } else if (response.status === 400) {\n                    log('‚ö†Ô∏è User already exists, trying login...', 'info');\n                    await testLogin();\n                } else {\n                    log(`‚ùå Registration failed: ${data.detail}`, 'error');\n                    updateStatus('login-status', `‚ùå Registration failed: ${data.detail}`, 'error');\n                    document.getElementById('login-test').className = 'test-section error';\n                }\n            } catch (error) {\n                log(`‚ùå Registration error: ${error.message}`, 'error');\n                updateStatus('login-status', `‚ùå Registration error: ${error.message}`, 'error');\n                document.getElementById('login-test').className = 'test-section error';\n            }\n        }\n        \n        async function testLogin() {\n            const email = document.getElementById('test-email').value;\n            const password = document.getElementById('test-password').value;\n            \n            if (!email || !password) {\n                log('‚ùå Please enter email and password', 'error');\n                return;\n            }\n            \n            log(`Testing login for ${email}...`);\n            try {\n                const response = await fetch(`${API_BASE}/auth/login`, {\n                    method: 'POST',\n                    headers: {'Content-Type': 'application/json'},\n                    body: JSON.stringify({email, password})\n                });\n                \n                const data = await response.json();\n                \n                if (response.ok && data.token) {\n                    token = data.token;\n                    log('‚úÖ Login successful', 'success');\n                    updateStatus('login-status', `‚úÖ Logged in - Credits: ${data.credits}, Admin: ${data.is_admin}`, 'success');\n                    document.getElementById('login-test').className = 'test-section success';\n                } else {\n                    log(`‚ùå Login failed: ${data.detail}`, 'error');\n                    updateStatus('login-status', `‚ùå Login failed: ${data.detail}`, 'error');\n                    document.getElementById('login-test').className = 'test-section error';\n                }\n            } catch (error) {\n                log(`‚ùå Login error: ${error.message}`, 'error');\n                updateStatus('login-status', `‚ùå Login error: ${error.message}`, 'error');\n                document.getElementById('login-test').className = 'test-section error';\n            }\n        }\n        \n        async function testAuth() {\n            if (!token) {\n                log('‚ùå No token available. Please login first.', 'error');\n                updateStatus('auth-status', '‚ùå No token available', 'error');\n                return;\n            }\n            \n            log('Testing authentication...');\n            try {\n                const response = await fetch(`${API_BASE}/auth/me`, {\n                    headers: {'Authorization': `Bearer ${token}`}\n                });\n                \n                if (response.ok) {\n                    const data = await response.json();\n                    log('‚úÖ Authentication successful', 'success');\n                    updateStatus('auth-status', `‚úÖ Authenticated - ${data.email} (${data.credits} credits)`, 'success');\n                    document.getElementById('auth-test').className = 'test-section success';\n                } else {\n                    log(`‚ùå Authentication failed: ${response.status}`, 'error');\n                    updateStatus('auth-status', `‚ùå Authentication failed: ${response.status}`, 'error');\n                    document.getElementById('auth-test').className = 'test-section error';\n                }\n            } catch (error) {\n                log(`‚ùå Authentication error: ${error.message}`, 'error');\n                updateStatus('auth-status', `‚ùå Authentication error: ${error.message}`, 'error');\n                document.getElementById('auth-test').className = 'test-section error';\n            }\n        }\n        \n        async function testEndpoint(endpoint, name) {\n            if (!token) {\n                log(`‚ùå ${name}: No token available`, 'error');\n                return;\n            }\n            \n            log(`Testing ${name} endpoint...`);\n            try {\n                const response = await fetch(`${API_BASE}${endpoint}`, {\n                    headers: {'Authorization': `Bearer ${token}`}\n                });\n                \n                const resultId = name.toLowerCase().replace(' ', '-') + '-result';\n                \n                if (response.ok) {\n                    const data = await response.json();\n                    log(`‚úÖ ${name} endpoint working`, 'success');\n                    document.getElementById(resultId).innerHTML = '<span style=\"color: #10b981;\">‚úÖ</span>';\n                } else {\n                    log(`‚ùå ${name} endpoint failed: ${response.status}`, 'error');\n                    document.getElementById(resultId).innerHTML = '<span style=\"color: #ef4444;\">‚ùå</span>';\n                }\n            } catch (error) {\n                log(`‚ùå ${name} endpoint error: ${error.message}`, 'error');\n                const resultId = name.toLowerCase().replace(' ', '-') + '-result';\n                document.getElementById(resultId).innerHTML = '<span style=\"color: #ef4444;\">‚ùå</span>';\n            }\n        }\n        \n        async function testVerification() {\n            if (!token) {\n                log('‚ùå No token available for verification test', 'error');\n                updateStatus('verification-status', '‚ùå No token available', 'error');\n                return;\n            }\n            \n            log('Testing verification creation...');\n            try {\n                const response = await fetch(`${API_BASE}/verify/create`, {\n                    method: 'POST',\n                    headers: {\n                        'Authorization': `Bearer ${token}`,\n                        'Content-Type': 'application/json'\n                    },\n                    body: JSON.stringify({\n                        service_name: 'telegram',\n                        capability: 'sms'\n                    })\n                });\n                \n                const data = await response.json();\n                \n                if (response.ok) {\n                    log('‚úÖ Verification created successfully', 'success');\n                    updateStatus('verification-status', `‚úÖ Created - ID: ${data.id}, Phone: ${data.phone_number}`, 'success');\n                    document.getElementById('verification-test').className = 'test-section success';\n                } else if (response.status === 402) {\n                    log('‚ö†Ô∏è Insufficient credits (expected)', 'info');\n                    updateStatus('verification-status', '‚ö†Ô∏è Insufficient credits (expected behavior)', 'warning');\n                    document.getElementById('verification-test').className = 'test-section warning';\n                } else {\n                    log(`‚ùå Verification failed: ${data.detail}`, 'error');\n                    updateStatus('verification-status', `‚ùå Failed: ${data.detail}`, 'error');\n                    document.getElementById('verification-test').className = 'test-section error';\n                }\n            } catch (error) {\n                log(`‚ùå Verification error: ${error.message}`, 'error');\n                updateStatus('verification-status', `‚ùå Error: ${error.message}`, 'error');\n                document.getElementById('verification-test').className = 'test-section error';\n            }\n        }\n        \n        async function testAdmin() {\n            if (!token) {\n                log('‚ùå No token available for admin test', 'error');\n                updateStatus('admin-status', '‚ùå No token available', 'error');\n                return;\n            }\n            \n            log('Testing admin access...');\n            try {\n                const response = await fetch(`${API_BASE}/admin/stats`, {\n                    headers: {'Authorization': `Bearer ${token}`}\n                });\n                \n                if (response.ok) {\n                    const data = await response.json();\n                    log('‚úÖ Admin access successful', 'success');\n                    updateStatus('admin-status', `‚úÖ Admin access - Users: ${data.total_users}, Verifications: ${data.total_verifications}`, 'success');\n                    document.getElementById('admin-test').className = 'test-section success';\n                } else if (response.status === 403) {\n                    log('‚ö†Ô∏è User is not admin (expected for regular users)', 'info');\n                    updateStatus('admin-status', '‚ö†Ô∏è Not admin (expected for regular users)', 'warning');\n                    document.getElementById('admin-test').className = 'test-section warning';\n                } else {\n                    log(`‚ùå Admin test failed: ${response.status}`, 'error');\n                    updateStatus('admin-status', `‚ùå Admin test failed: ${response.status}`, 'error');\n                    document.getElementById('admin-test').className = 'test-section error';\n                }\n            } catch (error) {\n                log(`‚ùå Admin test error: ${error.message}`, 'error');\n                updateStatus('admin-status', `‚ùå Error: ${error.message}`, 'error');\n                document.getElementById('admin-test').className = 'test-section error';\n            }\n        }\n        \n        // Auto-run connection test on page load\n        window.addEventListener('load', () => {\n            log('üöÄ Login Button Test Interface loaded');\n            setTimeout(testConnection, 1000);\n        });\n    </script>\n</body>\n</html>